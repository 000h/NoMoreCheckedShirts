<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.nmcs.sell">
	<!-- 장바구니 조회 -->
	<select id="selectCheckout" parameterType="int" resultType="kr.co.nmcs.dto.CheckoutDTO">
		SELECT t.tcode, t.ocode, op.scode, op.name, op.img, op.ea, op.price, t.tradate
		FROM transaction t, (SELECT o.ocode, o.scode, p.name, p.img, o.ea, o.price
		                       FROM orderlist o, productinfo p
		                      WHERE o.scode = p.scode) op
		WHERE t.ocode = op.ocode
		  AND t.trastatus = 0
		  AND t.acode = #{acode}
	</select>
	
	<!-- 주문품목 제거(장바구니 품목 빼기) -->
	<delete id="deleteOrder" parameterType="int">
		DELETE FROM orderlist
		 WHERE ocode = #{ocode}
	</delete>
	
	<!-- 장바구니 물품 개수 추가 -->
	<update id="updateOrderEA" parameterType="kr.co.nmcs.dto.OrderDTO">
		UPDATE orderlist
		   SET ea = #{ea}
		 WHERE ocode = #{ocode};
	</update>
</mapper>